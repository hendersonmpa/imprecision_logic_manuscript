% Created 2022-05-02 Mon 15:46
% Intended LaTeX compiler: pdflatex
\documentclass[review]{elsarticle}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{lineno}
\linenumbers
\usepackage{setspace}
\onehalfspacing
\authblk
\usepackage{pdfpages}
\usepackage{textpos}
\usepackage[final]{draftwatermark}
\usepackage{gensymb}
\usepackage{amsmath}
\usepackage{chemfig}
\setchemfig{atom style={scale=0.45}}
\usepackage[]{mhchem}
\date{}
\title{}
\hypersetup{
 pdfauthor={Matthew Henderson},
 pdftitle={},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 27.2 (Org mode 9.5)}, 
 pdflang={English}}
\usepackage[notquote]{hanging}
\begin{document}\makeatletter
\newcommand{\citeprocitem}[2]{\hyper@linkstart{cite}{citeproc_bib_item_#1}#2\hyper@linkend}
\makeatother



\begin{frontmatter}
\title{Imprecision Logic}
\author[NSO, UoO]{Matthew P.A. Henderson\corref{cor1}}
\ead{mhenderson@cheo.on.ca}
\author[NSO]{Michael Kowalski}
\author[NSO, UO]{Pranesh Chakraborty}
\address[NSO]{Newborn Screening Ontario, Children's Hospital of Eastern Ontario,Canada}
\address[UoO]{Department of Medicine, University of Ottawa,Canada} 
\cortext[cor1]{Corresponding author}
\end{frontmatter}

\section*{{\bfseries\sffamily TODO} Abstract (250 words)}
\label{sec:orge2a3966}
\begin{description}
\item[{Introduction}] 

\item[{Methods}] 

\item[{Results}] 

\item[{Conclusion}] 
\end{description}
\section*{{\bfseries\sffamily TODO} Keywords}
\label{sec:orgf553669}
\section*{{\bfseries\sffamily STARTED} Introduction}
\label{sec:orgc014789}

Newborn screening commonly uses algorithms based on biomarkers
measured in dried blood spot samples to identify neonates with an
increased probability of a target disorder. These screening
algorithms generally involve two or more phases of testing. All
samples are tested in the first phase and during this phase
sensitivity is emphasised over specificity, to identify samples with
higher probability of disease for additional investigation using an
approach that maintains high sensitivity with improved
specificity. Ideally an orthogonal analytical method or a different
biomarker(s) are employed in the second phase of screening, however in
a number of disorders the same assay is applied in duplicate during
the second phase of screening with a more specific confirmation
threshold applied to the mean of three biomarker measurements (Figure
\ref{fig:org2e19c20}). This approach improves the precision of the final
screening result, reducing the chance that a sample will be deemed
screen negative due to analytical imprecision.

Screening threshold values used in newborn screening are set based on
the distribution of the biomarker: in the healthy population, the
affected population and specific sub-populations based on demographics
such as age, gestational age and birth weight. The goal of the
laboratory is to identify samples with abnormal biomarker results
relative to these screening thresholds. The imprecision of the
screening method at analyte concentrations near the screening
threshold is useful in determining an appropriate initial screen
threshold to prompt repeat testing and reduce the effect analytical
imprecision on screening determinations (Figure \ref{fig:org2e19c20}). The
probability that a laboratory will incorrectly assign a screen
negative determination due to measurement error can be estimated from
the probability of a result near the screening in the screening
population and the imprecision of the method at the screening
threshold. This approach will be illustrated using the example of
newborn screening for galactosemia.

Newborn screening for galactosemia is based on measurement of
galactose-1-phosphate uridylyltransferase (GALT) activity in dried
blood spots. All samples are testing for GALT activity, GALT activity
is then tested in duplicate for all samples with activity below the
initial screening threshold. The mean of the three results is then
compared to the confirmation threshold. All results of the
confirmation phase are also subjected to medical scientific
review. Newborn screening for galactosemia will be used to demonstrate
the use of uncertainty of measurement for establishing thresholds in a
multi-stage testing algorithm, however this approach is applicable to
many testing scenarios in which biomarker results in a grey zone
must be identified for further investigation.

\begin{itemize}
\item Analytical drift due to factors such as calibrations and weather can
result in periodic bias
\item This should also be considered in determining impression logic
\end{itemize}



\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{./figures/screening_phases.pdf}
\caption{\label{fig:org2e19c20}Simplified Screening Algorithm for a Disorder with Low Biomarker Measurements}
\end{figure}

\clearpage

\section*{{\bfseries\sffamily TODO} Material and Methods}
\label{sec:orgda7ab7f}
\subsection*{GALT Activity Data}
\label{sec:org61b1553}
The laboratory information system was queried for all newborn
screening GALT activity results from the first phase of screening in
the period 2017-01-01 to 2018-12-31 (n = 285,875). This data was used
to determine the probability density function for GALT activity in the
population.

During the study period dried blood spot GALT activity was measured
on the SpotCheck Pro platform (Astoria Pacific, Oregon USA.). GALT
activity was reported in units per gram of hemoglobin (U/g Hb). 903
filter paper was used for dried blood spot sample collection (EBF,
South Carolina, USA).

\subsection*{Assay Impression at Screening Threshold}
\label{sec:org4370747}
The standard deviation of the GALT activity assay at the confirmation
threshold (1.5 U/g Hg) was determined based on six months of quality
control (QC) data for a QC material with mean GALT activity of 1.6 U/g
Hg.  \textbf{How many data points in six months of QC data}

\subsection*{Simulation}
\label{sec:org1e30e5d}
A simulation was used to examine multiple initial screening thresholds
where each initial threshold (I) is the confirmation threshold (C)
plus K number of standard deviation for K from 0 to 6 (Equation
\ref{eq:initial}). For each value of K the predicted annual number of
samples in grey zone between the confirm and initial threshold was
estimated by the area in this region of the probability density
function of GALT activity in the population.

\begin{equation}\label{eq:initial}
I = C + K\sigma , \{n|0\ge K\le6\} 
\end{equation}

The number of samples potentially affected by measurement imprecision
at the screening threshold was estimated by the area under the
probability density function of measurement error after scaling for
the probability of a result at the confirmation threshold in the
population (Equation \ref{eq:scaled}). Imprecision at the screening
threshold was modelled using a standardized normal distribution with
mean (\(\mu\)) equal to the confirmation threshold, and the standard
deviation (\(\sigma\)) of quality control results at the screening
threshold (Equation \ref{eq:error}). For each value of K used to set
an initial threshold (Equation \ref{eq:initial}) the number of samples
predicted to be affected by measurement imprecision and not included
in the grey zone was determined.

\begin{equation}\label{eq:scaled}
f(x) = \frac{e^{-(x-\mu)^2/2\sigma^2}}{\sigma \sqrt[2]{2\pi}} \cdot Pr[GALT = Threshold] 
\end{equation}

\begin{equation}\label{eq:error}
X \sim N(\mu, \sigma^2)
\end{equation}

\subsection*{{\bfseries\sffamily TODO} Software}
\label{sec:org39f8a28}
The manuscript was prepared using the Org-mode environment for
literate programming and reproducible research (\hyperlink{citeproc_bib_item_1}{Schulte et al. 2012}). The R language for statistical computing was used
for all data analysis with tidyverse packages for data manipulation,
\textbf{update} (\hyperlink{citeproc_bib_item_2}{Team 2020}; \hyperlink{citeproc_bib_item_3}{Wickham et al. 2019}). R scripts used for data
analysis are available here:
\url{https://github.com/hendersonmpa/imprecision\_logic\_manuscript.git}

\section*{{\bfseries\sffamily STARTED} Results}
\label{sec:org35078e4}

There are two main considerations when determining where to set the
initial threshold in a screening algorithm, one is the number of
samples that would require repeat testing and the other is the
potential for a false negative result during the first phase of
testing that does result in repeat analysis of the sample. A
simulation was run to determine the number of samples that would fall
in the "grey zone" and require repeat testing and those in "false
negative zone" as a function of the GALT activity threshold used in
the initial phase of screening (Figure \ref{fig:org1be3c88}). The "grey
zone" is the region between the initial and confirmation thresholds
and all samples with GALT activity in this range are repeated in
duplicate (Figure \ref{fig:org2e19c20}). All GALT results above the initial
threshold are potentially false negative however the probablity that
the result is falsely negative do to analytical imprecision is
determined by they analytical imprecision at the confirmation
threshold (Figure \ref{fig:org1be3c88}, 1 \(\sigma\) threshold and red area).

There is a trade-off between the number of samples that require repeat
testing and the number that could be false negative due to analytical
imprecision. The tolerance for a false negative first tier screening
results in newborn screening is very low, therefore, the most
appropriate expansion factor should be applied to avoid this
possibility. Table \ref{tab:imprecision} shows the predicted number of
annual samples in the repeat zone and false negative zone.

\begin{figure}[htbp]
\centering
\includegraphics[width=0.9\textwidth]{./figures/galtthresholds.pdf}
\caption{\label{fig:org1be3c88}The left side of the GALT activity population distribution.}
\end{figure}


% latex table generated in R 4.0.3 by xtable 1.8-4 package
% Mon May  2 15:46:01 2022
\begin{table}[ht]
\centering
\begin{tabular}{rrrr}
  \hline
Expansion Factor & Initial Threshold & Grey Zone Samples & False Negative Zone Samples \\ 
  \hline
  0 & 1.50 & 0.00 & 9.5 \\ 
    1 & 1.70 & 10.15 & 3.1 \\ 
    2 & 1.90 & 23.20 & 0.45 \\ 
    3 & 2.10 & 49.30 & 0.027 \\ 
    4 & 2.30 & 92.80 & 0.00066 \\ 
    5 & 2.50 & 142.10 & 6e-06 \\ 
    6 & 2.70 & 221.85 & 9.2e-23 \\ 
   \hline
\end{tabular}
\caption{Imprecision Based Initial Thresholds} 
\label{tab:imprecision}
\end{table}

\clearpage

\section*{{\bfseries\sffamily TODO} Discussion}
\label{sec:orgc454393}

\begin{table}[htbp]
\caption[sigma]{\label{tab:org02d2003}Probability of a false negative screen due to imprecision}
\centering
\begin{tabular}{rrl}
SD & probability of false negative & count\\
\hline
1 & 0.1586553\\
2 & 0.02275013\\
3 & 0.001349898\\
4 & 3.167124ee-05\\
5 & 2.866516ee-07\\
6 & 9.865876ee-10\\
\end{tabular}
\end{table}

\section*{{\bfseries\sffamily TODO} Conclusions}
\label{sec:org7bb9d72}

\section*{{\bfseries\sffamily DONE} Acknowledgments}
\label{sec:org04b8520}
Funding: None.
\section*{References}
\label{sec:org4c9f7b9}
\begin{hangparas}{1.5em}{1}
\hypertarget{citeproc_bib_item_1}{Schulte, Eric, Dan Davison, Thomas Dye, and Carsten Dominik. 2012. “A Multi-Language Computing Environment for Literate Programming and Reproducible Research.” \textit{Journal of Statistical Software} 46 (3):1–11. \href{https://doi.org/10.18637/jss.v046.i03}{https://doi.org/10.18637/jss.v046.i03}.}

\hypertarget{citeproc_bib_item_2}{Team, R Core. 2020. \textit{R: A Language and Environment for Statistical Computing}. Vienna, Austria: R Foundation for Statistical Computing. \href{https://www.R-project.org/}{https://www.R-project.org/}.}

\hypertarget{citeproc_bib_item_3}{Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the tidyverse.” \textit{Journal of Open Source Software} 4 (43):1686. \href{https://doi.org/10.21105/joss.01686}{https://doi.org/10.21105/joss.01686}.}
\end{hangparas}
\end{document}